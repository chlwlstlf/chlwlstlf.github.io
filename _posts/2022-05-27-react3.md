---
layout: single
title: "ë¦¬ì•¡íŠ¸ ê³µë¶€ - ì‡¼í•‘ëª°2"
categories: react
toc: true
toc_sticky: true
---

# 2022 ì½”ë”©ì• í”Œ ë¦¬ì•¡íŠ¸ ê°•ì˜

## <mark style='background-color: #ffdce0'> ğŸ“‚Redux </mark>

1\. store.js íŒŒì¼ ìƒì„± & ì½”ë“œ ë³µë¶™  
2\. index.js ê°€ì„œ <Provider stor{store}> ì“°ê¸°  
3\. ì—¬ëŸ¬ jsì—ì„œ ì‚¬ìš©í•˜ê¸°

> store.js

```jsx
import {configureStore} from '@reduxjs/toolkit'

let user = createSlice({ //ìŠ¬ë¼ì´ìŠ¤ë¼ê³  ë¶€ë¦„
  name : 'user'
  initialState : 'jinsil'
})

let stock = createSlice({
  name : 'stock'
  initialState : [10, 11, 12]
})

export default configureStore({
  reducer:{
    user : user.reducer,
    stock : stock.reducer
  }
})
```

> index.js

```jsx
import { Provider } from "react-redux";
import store from "./store.js";

root.render(
  <Provider store={store}>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </Provider>
);
```

> Cart.js

```jsx
import { useSelector } from "react-redux";

function Cart() {
  let a = useSelector((state) => {
    return state.user;
  }); //store.jsì— ìˆëŠ” user ìŠ¬ë¼ì´ìŠ¤ ê°€ì ¸ì˜´

  return <div></div>;
}
```

ì“°ëŠ” ì´ìœ  : ì»´í¬ë„ŒíŠ¸ê°„ state ê³µìœ  í¸í•´ì§

---

## <mark style='background-color: #ffdce0'> ğŸ“‚Reduxì˜ state ë³€ê²½</mark>

1\. state ìˆ˜ì •í•´ì£¼ëŠ” í•¨ìˆ˜ ë§Œë“¤ê¸°  
2\. ì›í•  ë•Œ ê·¸ í•¨ìˆ˜ ì‹¤í–‰í•´ë‹¬ë¼ê³  store.jsì— ìš”ì²­  
3\. ë§Œë“  í•¨ìˆ˜ import í•´ì„œ ì‚¬ìš©

> store.js

```jsx
import {configureStore} from '@reduxjs/toolkit'

let user = createSlice({
  name : 'user'
  initialState : [
    {name : 'jinsil', age : 20},
    {name : 'park', age : 30},
  ], //ë³€ìˆ˜ í•˜ë‚˜ì—¬ë„ object ì•ˆì— ë„£ëŠ”ê²Œ í¸í•¨
  reducers : {
    changeName(state){ //ê¸°ì¡´ state
      state.name = 'park'
    }
    increase(state, a){
      let number = state.findIndex((a)=>{return a.id === action.payload})
      state.age += a.payloade
    }
  }
})

export let {changeName, increase} = user.actions //actions : state ë³€ê²½ í•¨ìˆ˜ë“¤
```

> Cart.js

```jsx
import { useSelector, useDispatch } from "react-redux";
import { changeName } from "./../store"; //import í•´ì˜´

function Cart() {
  let state = useSelector((state) => state);
  let dispatch = useDispatch(); //store.jsë¡œ ìš”ì²­ ë³´ë‚´ì£¼ëŠ” í•¨ìˆ˜

  return (
    <div>
      <button
        onClick={() => {
          dispatch(changeName());
        }}
      >
        ë²„íŠ¼
      </button>
      <button
        onClick={() => {
          dispatch(increase(100));
        }}
      >
        +
      </button>
    </div>
  );
}
```

---

## <mark style='background-color: #ffdce0'> ğŸ“‚localStorage </mark>

1\. ì…ë ¥

> localStorage.setItem('age', '20')

2\. ì¶œë ¥

> localStorage.getItem('age') â†’ '20' ì¶œë ¥ë¨

3\. ì‚­ì œ

> localStorage.removeItem('age')

4\. array/object ì €ì¥ : JSONìœ¼ë¡œ ë°”ê¾¸ê¸°

```jsx
function App() {
  //ì…ë ¥
  let obj = { name: "kim" };
  localStorage.setItem("data", JSON.stringify(obj));

  //ì¶œë ¥
  let result = localStorage.getItem("data");
  JSON.parse(result); //objectë¡œ ë³€í™˜
}
```

5\. ìµœê·¼ ë³¸ ìƒí’ˆ ë§Œë“¤ê¸°

- ëˆ„ê°€ Detail í˜ì´ì§€ ì ‘ì†í•˜ë©´ (useEffect)
- ê·¸ í˜ì´ì§€ì— ë³´ì´ëŠ” ìƒí’ˆ ID ê°€ì ¸ì™€ì„œ (ì°¾ì€ìƒí’ˆ.id)
- localStorageì˜ watched í•­ëª©ì— ì¶”ê°€ (getItem, ë³€ê²½, setItem)

```jsx
function Detail(props) {
  let { id } = useParams();
  let ì°¾ì€ìƒí’ˆ = props.shoes.find((x) => x.id == id);
  let [alert, setAlert] = useState(true);
  let [tab, setTab] = useState(0);
  let dispatch = useDispatch();

  useEffect(() => {
    let result = localStorage.getItem("watched");
    result = JSON.parse(result);
    result.push(ì°¾ì€ìƒí’ˆ.id);
    localStorage.setItem("watched", JSON.stringify(result));
  }, []);
}
```

---

## <mark style='background-color: #ffdce0'> ğŸ“‚react-query </mark>

1\. í„°ë¯¸ë„ì— '<mark style='background-color: #fff5b1'>npm install react-query</mark>' ì…ë ¥

2\. index.js ì…‹íŒ…

- import {QueryClient, QueryClientProvider} from "react-query";
- const queryClient = new QueryClient()
- `<QueryClientProvider client={queryClient}>`  
   `<App />`  
  `</QueryClientProvider>`

3\. ë¬¸ë²•

```jsx
let result = useQuery("ì‘ëª…", () =>
  axios.get("ë§í¬").then((a) => {
    return a.data;
  })
);
```

4\. ì¥ì 

- ì„±ê³µ/ì‹¤íŒ¨/ë¡œë”© ì¤‘ ì‰½ê²Œ íŒŒì•… ê°€ëŠ¥  
  {result.isLoding ? 'ë¡œë”©ì¤‘' : result.data.name}

- ìë™ìœ¼ë¡œ refetch í•´ì¤Œ
  {stateTime : 2000}

- ì‹¤íŒ¨ ì‹œ retry ì•Œì•„ì„œ í•´ì¤Œ

- state ê³µìœ  ì•ˆ í•´ë„ ë¨

- ajsx ê²°ê³¼ ìºì‹± ê¸°ëŠ¥
